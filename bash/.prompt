# This file defines bash prompt

YELLOW_B="\e[1;33m";
WHITE_B="\e[1;37m";
GREEN_B="\e[1;32m";
RED_B="\e[1;31m";
PURPLE_B="\e[1;35m";

CYAN="\e[0;36m";
WHITE="\e[0;37m";
PURPLE="\e[0;35m";

WHITE_BG="\e[47m"
PURPLE_BG="\e[45m"
CYAN_BG="\e[36m"
BLUE_BG="\e[44m"
BLACK_BG="\e[40m"
GREEN_BG="\e[42m"

RESET="\e[00m";

function bash_prompt() {
    # Get smiley based on last status
    local last_status=$?
    local smiley="‚úî"
    if [[ "$last_status" != "0" ]]; then
       smiley="‚úò";
    fi


    # Get git branch
    local git_branch=`git rev-parse --abbrev-ref HEAD 2> /dev/null`
    #local git_branch=`git branch --show-current 2> /dev/null`
	if [ "$git_branch" ]; then
		git_branch=" ‚éá  $git_branch "
	fi

    # Get PWD
    local curr_dir=${PWD/#$HOME/'~'}
    curr_dir=`echo "${curr_dir}" | sed -e s#\/#\ ‚Æö\ #g`

    local no_of_chars=`echo $curr_dir | wc -c`
    no_of_chars=$(($no_of_chars+0))

    if [[ $no_of_chars -ge 50 ]]; then
        curr_dir="... ${curr_dir:(-50)}"
    fi

    curr_dir=" üóÅ   ${curr_dir}"



    # Get current virtual environment
    local venv=""
    if [ "$VIRTUAL_ENV" != "" ]; then
        venv=" ‚Ñ∞ $(basename $VIRTUAL_ENV) "
    fi

    #Title
    local os=`uname -s -r`
    local title="\033]0;${os}: \u\a"
    # Build everything together
    PROMPT="${title}\n"
    PROMPT+="${BLACK_BG}${WHITE_B} üñ≥  \u "
    PROMPT+="${BLUE_BG}${WHITE_B} ${smiley}"
    PROMPT+="${BLUE_BG}${WHITE_B} \# "
    PROMPT+="${PURPLE_BG}${WHITE_B}${venv}"
    PROMPT+="${GREEN_BG}${WHITE_B}${git_branch}"
    PROMPT+="${RESET}${CYAN}${curr_dir}"
    PROMPT+="\n${BLUE_BG}${WHITE} ‚û§ ${RESET}"
    echo -e "${PROMPT}"
}

PROMPT_COMMAND='PS1=$(bash_prompt)'
export PROMPT_COMMAND
export PS1;
